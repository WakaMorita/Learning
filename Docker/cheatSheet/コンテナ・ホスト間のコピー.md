## Dockerコンテナ・ホスト間のファイルコピー手順

### 概要
このガイドでは、Dockerコンテナとホストマシン間でファイルをコピーする方法について説明します。
`docker cp`コマンドを使用して、コンテナとホスト間で双方向のファイル転送が可能です。

### 重要な注意事項
1. コンテナ内のファイルパスは、コンテナの構造に依存します
2. ホスト側のパスは絶対パスで指定することを推奨
3. コピー先のディレクトリが存在しない場合は自動作成されます
4. コピー元のファイルやディレクトリが存在しない場合はエラーになります

### 基本的な使用方法

#### 1. コマンドの構文
```bash
# ホストからコンテナへのコピー
docker cp <ホストのパス> <コンテナ名>:<コンテナ内のパス>

# コンテナからホストへのコピー
docker cp <コンテナ名>:<コンテナ内のパス> <ホストのパス>
```

#### 2. 実践例：Apache HTTPDでの検証

##### コンテナの作成と起動

###### コンテナ設定
- コンテナ名: `apa000ex19`
- image名: `httpd`
- ポート設定: `8089`（ホスト） → `80`（コンテナ）

```bash
# Apacheコンテナを作成・起動
docker run --name apa000ex19 -d -p 8089:80 httpd
```

<details>
<summary>📝 コマンドのパラメータ説明</summary>

- `--name`: コンテナ名を指定
- `-d`: デタッチモードで実行（バックグラウンド実行）
- `-p`: ポートマッピング（ホスト:コンテナ）
- `httpd`: Apache HTTPDのDockerイメージ
</details>

##### ファイルのコピー例

1. ホストからコンテナへのコピー
```bash
# HTMLファイルをコンテナのドキュメントルートへコピー
docker cp C:\Users\waka_\Documents\Learning\Docker\index.html apa000ex19:/usr/local/apache2/htdocs/
```

2. コンテナからホストへのコピー
```bash
# コンテナ内のHTMLファイルをホストへコピー
docker cp apa000ex19:/usr/local/apache2/htdocs/index.html C:\Users\waka_\Documents\Learning\Docker
```

### トラブルシューティング

<details>
<summary>🔍 よくあるエラーと解決方法</summary>

1. パスが見つからない場合
   - コンテナ名とパスが正しいか確認
   - コンテナが実行中か確認（`docker ps -a`）
   - ファイルの権限を確認

2. コピーが失敗する場合
   - コンテナが起動しているか確認
   - パスにスペースが含まれる場合はクォートで囲む
   - ファイルの所有者と権限を確認
</details>

### セキュリティに関する推奨事項
1. ファイル転送時の注意点
   - 機密情報を含むファイルの取り扱いに注意
   - 実行権限のあるファイルの転送は慎重に
   - 本番環境でのファイル操作は十分な検証後に実施

2. 権限管理
   - コピーしたファイルの所有者とパーミッションを適切に設定
   - 必要最小限の権限で実行

### その他の便利な使用例

#### ディレクトリ全体のコピー
```bash
# ホストからコンテナへディレクトリをコピー
docker cp ./my-website/ apa000ex19:/usr/local/apache2/htdocs/

# コンテナからホストへディレクトリをコピー
docker cp apa000ex19:/usr/local/apache2/htdocs/ ./backup/
```

#### 複数ファイルの一括コピー
```bash
# 複数のファイルを含むディレクトリをコピー
docker cp ./assets/ apa000ex19:/usr/local/apache2/htdocs/
```

参考文献：Docker&Kubernetesのきほんのきほん
